{"update_time":"2019-06-24T19:37:16.003Z","content":{"html":"<div data-block-id=\"8b317d81-aac0-4f75-b8e6-9026d3c79614\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 2px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">随着本站的功能逐渐完善，开发工作告一段落。接下来是解决一些用户体验的问题，根据我本人的访问体验以及他人的反馈，我会对站点逐步进行优化。下面是关于访问速度和性能方面的优化。</div></div></div></div><div data-block-id=\"fc1a12c7-8b40-4f74-81de-248a9bc34695\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.4);\"></div></div></div></div><div data-block-id=\"9dea52a3-a2dc-4347-849a-b22a3c304af9\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">本文以本站点为例，记录优化过程。本站是由 gatsby 构建的、部署在 netlify 上的静态网页（部分动态）。因此以下经验也适用于相同技术的站点优化。</div></div></div></div><div data-block-id=\"aca05adf-b695-4319-acdc-5696cc6cf602\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.4);\"></div></div></div></div><div data-block-id=\"f40d7a8f-da36-4280-bb2c-82a97f4cb9c8\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">技术关键词</div></div></div></div><div data-block-id=\"b381fb83-829d-461b-8572-d5602620cd2f\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: rgb(55, 53, 47);\"><div style=\"margin-right: 4px; width: 24px; flex-grow: 0; flex-shrink: 0; display: flex; align-items: center; justify-content: center; min-height: calc((1.5em + 3px) + 3px); padding-right: 2px;\"><div style=\"width: 6px; height: 6px; border-radius: 6px; background: currentcolor; margin-top: 0.1em;\"></div></div><div style=\"flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\"List\" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding-top: 3px; padding-bottom: 3px; text-align: left;\">gatsby</div></div></div></div></div><div data-block-id=\"12c7e26c-c515-4b47-ac68-3be0b9dd93a0\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: rgb(55, 53, 47);\"><div style=\"margin-right: 4px; width: 24px; flex-grow: 0; flex-shrink: 0; display: flex; align-items: center; justify-content: center; min-height: calc((1.5em + 3px) + 3px); padding-right: 2px;\"><div style=\"width: 6px; height: 6px; border-radius: 6px; background: currentcolor; margin-top: 0.1em;\"></div></div><div style=\"flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\"List\" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding-top: 3px; padding-bottom: 3px; text-align: left;\">netlify functions</div></div></div></div></div><div data-block-id=\"0ce68b8f-31d1-4f20-b22d-ff75a64226d4\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: rgb(55, 53, 47);\"><div style=\"margin-right: 4px; width: 24px; flex-grow: 0; flex-shrink: 0; display: flex; align-items: center; justify-content: center; min-height: calc((1.5em + 3px) + 3px); padding-right: 2px;\"><div style=\"width: 6px; height: 6px; border-radius: 6px; background: currentcolor; margin-top: 0.1em;\"></div></div><div style=\"flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\"List\" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding-top: 3px; padding-bottom: 3px; text-align: left;\">netlify caches</div></div></div></div></div><div data-block-id=\"e7aa72d9-55b7-48c1-9dbe-c92aa579899e\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: rgb(55, 53, 47);\"><div style=\"margin-right: 4px; width: 24px; flex-grow: 0; flex-shrink: 0; display: flex; align-items: center; justify-content: center; min-height: calc((1.5em + 3px) + 3px); padding-right: 2px;\"><div style=\"width: 6px; height: 6px; border-radius: 6px; background: currentcolor; margin-top: 0.1em;\"></div></div><div style=\"flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\"List\" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding-top: 3px; padding-bottom: 3px; text-align: left;\">PWA</div></div></div></div></div><div data-block-id=\"2641bbcc-66ae-4062-836a-2a90511a419c\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.4);\"></div></div></div></div><div data-block-id=\"654a0834-ba4f-4540-bd12-521bd661dd4b\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">优化工作主要参考 gatsby 以及  netlify 的文档。参见</div></div></div></div><div data-block-id=\"0eeb50b8-8374-4ca7-862f-44baa40f99e9\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 4px; margin-bottom: 4px;\"><div><div style=\"display: flex;\"><a href=\"#\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"display: block; color: inherit; text-decoration: none; flex-grow: 1; min-width: 0px;\"><div style=\"cursor: pointer; user-select: none; transition: background 120ms ease-in 0s; width: 100%; display: flex; flex-wrap: wrap-reverse; align-items: stretch; text-align: left; overflow: hidden; border: 1px solid rgba(55, 53, 47, 0.16); border-radius: 3px; position: relative; color: rgb(55, 53, 47);\"><div style=\"flex: 4 1 180px; min-height: 60px; padding: 12px 14px 14px; overflow: hidden; text-align: left;\"><div style=\"font-size: 14px; margin-bottom: 2px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;\">Performance</div><div style=\"font-size: 12px; line-height: 1.3; color: rgba(55, 53, 47, 0.6); max-height: 32px; overflow: hidden;\">Skip to main content Register now: \"ImpossibleFoods.com: Combining Gatsby + Contentful for Speed, Scale and Flexibility\" Webinar 6/26 10am PT While performance is already at the heart of Gatsby, it's important to ensure you are doing all you can to make your content available to your users as fast as possible.</div><div style=\"font-size: 12px; line-height: 16px; display: flex; overflow: hidden; margin-top: 6px;\"><img src=\"https://www.gatsbyjs.org/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606\" style=\"width: 16px; height: 16px; min-width: 16px; margin-right: 6px;\"><div style=\"min-width: 0px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;\">https://www.gatsbyjs.org/docs/performance/</div></div></div><div style=\"flex: 1 1 180px; min-height: 80px; display: block; position: relative;\"><div style=\"position: absolute; top: 0px; left: 0px; right: 0px; bottom: 0px;\"><div style=\"width: 100%; height: 100%;\"><img src=\"https://www.notion.so/image/https%3A%2F%2Fwww.gatsbyjs.org%2Fstatic%2Fgatsby-icon-4a9773549091c227cd2eb82ccd9c5e3a.png?table=block&amp;id=0eeb50b8-8374-4ca7-862f-44baa40f99e9&amp;width=500&amp;cache=v2\" style=\"display: block; object-fit: cover; border-radius: 1px; width: 100%; height: 100%;\"></div></div></div></div></a></div></div></div><div data-block-id=\"58739b7f-6e9c-404a-8b5f-3da4a801c978\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 4px; margin-bottom: 4px;\"><div><div style=\"display: flex;\"><a href=\"#\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"display: block; color: inherit; text-decoration: none; flex-grow: 1; min-width: 0px;\"><div style=\"cursor: pointer; user-select: none; transition: background 120ms ease-in 0s; width: 100%; display: flex; flex-wrap: wrap-reverse; align-items: stretch; text-align: left; overflow: hidden; border: 1px solid rgba(55, 53, 47, 0.16); border-radius: 3px; position: relative; color: rgb(55, 53, 47);\"><div style=\"flex: 4 1 180px; min-height: 60px; padding: 12px 14px 14px; overflow: hidden; text-align: left;\"><div style=\"font-size: 14px; margin-bottom: 2px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;\">netlify.toml Reference | Netlify</div><div style=\"font-size: 12px; line-height: 1.3; color: rgba(55, 53, 47, 0.6); max-height: 32px; overflow: hidden;\">Netlify builds, deploys, and hosts your front end. Learn how to get started, see examples, and view documentation for the modern web platform.</div><div style=\"font-size: 12px; line-height: 16px; display: flex; overflow: hidden; margin-top: 6px;\"><img src=\"https://www.netlify.com/img/global/favicon/favicon-16x16.png\" style=\"width: 16px; height: 16px; min-width: 16px; margin-right: 6px;\"><div style=\"min-width: 0px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;\">https://www.netlify.com/docs/netlify-toml-reference/</div></div></div><div style=\"flex: 1 1 180px; min-height: 80px; display: block; position: relative;\"><div style=\"position: absolute; top: 0px; left: 0px; right: 0px; bottom: 0px;\"><div style=\"width: 100%; height: 100%;\"><img src=\"https://www.notion.so/image/https%3A%2F%2Fwww.netlify.com%2Fimg%2Fglobal%2Fmeta-image.jpg?table=block&amp;id=58739b7f-6e9c-404a-8b5f-3da4a801c978&amp;width=500&amp;cache=v2\" style=\"display: block; object-fit: cover; border-radius: 1px; width: 100%; height: 100%;\"></div></div></div></div></a></div></div></div><div data-block-id=\"153ce0d2-2efd-4115-ab8b-91f4cc3fe7d8\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.4);\"></div></div></div></div><div data-block-id=\"012b2391-a1d5-4bcd-87bb-b87263752c67\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1em; margin-bottom: 1px; color: rgb(55, 53, 47);\"><div style=\"display: flex; width: 100%; font-weight: 600; font-size: 1.5em; letter-spacing: -0.002em; line-height: 1.2; color: rgb(55, 53, 47);\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\"Heading 2\" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">缓存</div></div></div><div data-block-id=\"b1b4381a-cfee-4761-9fd1-ce02dfff0604\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">根目录下添加 <span style=\"font-family:'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:normal;background:rgba(135,131,120,0.15);color:#EB5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em\" data-token-index=\"1\">netlify.toml</span> 文件，可以控制 netlify 的请求行为（当然还有很多其它功能）。</div></div></div></div><div data-block-id=\"1c9984bd-a09b-4dec-bc6b-89f867d1384e\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">JS、 CSS 和 静态文件都需要缓存。但是 <span style=\"font-weight:600\" data-token-index=\"1\">sw.js 不能缓存</span>，这一点在 gatsby 的文档中有提到。</div></div></div></div><div data-block-id=\"0402b1b8-dd80-44b1-b4be-dc43e9d4fa82\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 4px; margin-bottom: 4px;\"><div style=\"display: flex;\"><div style=\"flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;\"><div class=\"line-numbers notion-code-block\" style=\"display: flex; overflow-x: auto;\"><div contenteditable=\"false\" spellcheck=\"false\" autocorrect=\"off\" autocapitalize=\"off\" data-root=\"true\" style=\"flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 30px 16px 30px 20px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre;\"><span class=\"token punctuation\" data-token-index=\"0\">[</span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span data-token-index=\"0\">headers</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span data-token-index=\"0\">\n  </span><span class=\"token keyword\" data-token-index=\"0\">for</span><span data-token-index=\"0\"> </span><span class=\"token operator\" data-token-index=\"0\">=</span><span data-token-index=\"0\"> </span><span class=\"token string\" data-token-index=\"0\">\"*.js\"</span><span data-token-index=\"0\">\n  </span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span data-token-index=\"0\">headers</span><span class=\"token punctuation\" data-token-index=\"0\">.</span><span data-token-index=\"0\">values</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span data-token-index=\"0\">\n    Cache</span><span class=\"token operator\" data-token-index=\"0\">-</span><span data-token-index=\"0\">Control </span><span class=\"token operator\" data-token-index=\"0\">=</span><span data-token-index=\"0\"> </span><span class=\"token string\" data-token-index=\"0\">\"public, max-age=31536000,immutable\"</span><span data-token-index=\"0\">\n\n</span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span data-token-index=\"0\">headers</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span data-token-index=\"0\">\n  </span><span class=\"token keyword\" data-token-index=\"0\">for</span><span data-token-index=\"0\"> </span><span class=\"token operator\" data-token-index=\"0\">=</span><span data-token-index=\"0\"> </span><span class=\"token string\" data-token-index=\"0\">\"/sw.js\"</span><span data-token-index=\"0\">\n  </span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span data-token-index=\"0\">headers</span><span class=\"token punctuation\" data-token-index=\"0\">.</span><span data-token-index=\"0\">values</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span data-token-index=\"0\">\n    Cache</span><span class=\"token operator\" data-token-index=\"0\">-</span><span data-token-index=\"0\">Control </span><span class=\"token operator\" data-token-index=\"0\">=</span><span data-token-index=\"0\"> </span><span class=\"token string\" data-token-index=\"0\">\"public, max-age=0, must-revalidate\"</span><span data-token-index=\"0\">\n\n</span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span data-token-index=\"0\">headers</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span data-token-index=\"0\">\n  </span><span class=\"token keyword\" data-token-index=\"0\">for</span><span data-token-index=\"0\"> </span><span class=\"token operator\" data-token-index=\"0\">=</span><span data-token-index=\"0\"> </span><span class=\"token string\" data-token-index=\"0\">\"*.css\"</span><span data-token-index=\"0\"> \n  </span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span data-token-index=\"0\">headers</span><span class=\"token punctuation\" data-token-index=\"0\">.</span><span data-token-index=\"0\">values</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span data-token-index=\"0\">\n    Cache</span><span class=\"token operator\" data-token-index=\"0\">-</span><span data-token-index=\"0\">Control </span><span class=\"token operator\" data-token-index=\"0\">=</span><span data-token-index=\"0\"> </span><span class=\"token string\" data-token-index=\"0\">\"public, max-age=31536000,immutable\"</span><span data-token-index=\"0\">\n\n</span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span data-token-index=\"0\">headers</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span data-token-index=\"0\">\n  </span><span class=\"token keyword\" data-token-index=\"0\">for</span><span data-token-index=\"0\"> </span><span class=\"token operator\" data-token-index=\"0\">=</span><span data-token-index=\"0\"> </span><span class=\"token string\" data-token-index=\"0\">\"*.jpg\"</span><span data-token-index=\"0\"> \n  </span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span data-token-index=\"0\">headers</span><span class=\"token punctuation\" data-token-index=\"0\">.</span><span data-token-index=\"0\">values</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span data-token-index=\"0\">\n    Cache</span><span class=\"token operator\" data-token-index=\"0\">-</span><span data-token-index=\"0\">Control </span><span class=\"token operator\" data-token-index=\"0\">=</span><span data-token-index=\"0\"> </span><span class=\"token string\" data-token-index=\"0\">\"public, max-age=31536000,immutable\"</span><span data-token-index=\"0\">\n\n</span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span data-token-index=\"0\">headers</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span data-token-index=\"0\">\n  </span><span class=\"token keyword\" data-token-index=\"0\">for</span><span data-token-index=\"0\"> </span><span class=\"token operator\" data-token-index=\"0\">=</span><span data-token-index=\"0\"> </span><span class=\"token string\" data-token-index=\"0\">\"*.png\"</span><span data-token-index=\"0\"> \n  </span><span class=\"token punctuation\" data-token-index=\"0\">[</span><span data-token-index=\"0\">headers</span><span class=\"token punctuation\" data-token-index=\"0\">.</span><span data-token-index=\"0\">values</span><span class=\"token punctuation\" data-token-index=\"0\">]</span><span data-token-index=\"0\">\n    Cache</span><span class=\"token operator\" data-token-index=\"0\">-</span><span data-token-index=\"0\">Control </span><span class=\"token operator\" data-token-index=\"0\">=</span><span data-token-index=\"0\"> </span><span class=\"token string\" data-token-index=\"0\">\"public, max-age=31536000,immutable\"</span><span>\n</span></div></div><div style=\"position: absolute; top: 0px; right: 0px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 30px;\"></div><div style=\"position: absolute; bottom: 0px; right: 0px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 30px;\"><div style=\"cursor: default; user-select: none; transition: background 120ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;\">OCaml<svg viewBox=\"0 0 30 30\" style=\"width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;\"><polygon points=\"15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 \"></polygon></svg></div></div></div></div></div><div data-block-id=\"5e10794e-3c11-4b46-82b8-a3ec3078b2ba\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">不知道能不能写正则（待求证）</div></div></div></div><div data-block-id=\"b4864876-83ef-4625-a4db-7a1ac3d1f8a9\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1em; margin-bottom: 1px; color: rgb(55, 53, 47);\"><div style=\"display: flex; width: 100%; font-weight: 600; font-size: 1.5em; letter-spacing: -0.002em; line-height: 1.2; color: rgb(55, 53, 47);\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\"Heading 2\" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">网络优化</div></div></div><div data-block-id=\"742af2fd-ac2c-47b2-a044-3e36c54c09be\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.4);\"></div></div></div></div><div data-block-id=\"2adb75c6-1c56-4bc2-9ce4-862137ba22bf\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">目前博客首次加载的的速度非常慢，在较差的网络环境下sw 的安装长达4分钟之久。这对初次访问站点的用户非常不友好。</div></div></div></div><div data-block-id=\"69c9e67d-18b9-4f9e-988e-e0f0f31838ed\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">虽然首屏渲染的时间不长，但是 JS 等文件未加载成功。因此很多操作无法进行。这造成了较差的用户体验。</div></div></div></div><div data-block-id=\"b66d257d-0068-4a68-9d12-bf75fdbc99a0\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">观察了到某次网络请求，大部分请求的 TTFB 长达 10s 之久。netlify 的表现不尽人意。比较了一下速度，跟 github page 不相上下。可能真的需要上国内 CDN 了。</div></div></div></div><div data-block-id=\"f52ea1fd-89cb-433c-b4e9-e5f18d0f9e8f\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.4);\"></div></div></div></div><div data-block-id=\"5258ce19-6501-4e80-8119-72d39b56e366\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1em; margin-bottom: 1px; color: rgb(55, 53, 47);\"><div style=\"display: flex; width: 100%; font-weight: 600; font-size: 1.5em; letter-spacing: -0.002em; line-height: 1.2; color: rgb(55, 53, 47);\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\"Heading 2\" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">写在后面的碎碎念</div></div></div><div data-block-id=\"8817ccbb-3197-44c7-a8ba-1606d3668101\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.4);\"></div></div></div></div><div data-block-id=\"fa4397a4-52f3-41cd-810b-75340053de4c\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">我个人比较推崇 serverless，从本站的实现和部署就可以看出来。我根本不想操心任何服务器的事情，所以全用的第三方服务。</div></div></div></div><div data-block-id=\"d91e8265-61a5-4380-8601-5b0b8704b55d\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">但是这也有缺点，缺点就是你不能随心所欲的控制服务端了。可能也算不上缺点吧，某种意义上来说操心的东西变少了，未尝不是一件好事。只不过相对而言牺牲了一定的自由度。</div></div></div></div><div data-block-id=\"8680c6a6-f4ff-4bb6-a388-a3e4ab7bd84e\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">有好有坏吧，服务端的优化能插手的地方比较少。只能照着文档来，别人给什么就用什么吧。</div></div></div></div><div data-block-id=\"7848c71d-c198-49ea-99b3-fc6c5f95ce8b\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 1px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.4);\"></div></div></div></div><div data-block-id=\"3e8f0f2f-9e07-4297-ad1f-895a1d7cbd3b\" class=\"notion-selectable\" style=\"width: 100%; max-width: calc((100vw - 0px) - 192px); margin-top: 1px; margin-bottom: 0px;\"><div style=\"color: rgb(55, 53, 47);\"><div style=\"display: flex;\"><div contenteditable=\"false\" spellcheck=\"true\" placeholder=\" \" data-root=\"true\" style=\"max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;\">下一篇会从客户端的角度继续优化。</div></div></div></div>","brief":"随着本站的功能逐渐完善，开发工作告一段落。接下来是解决一些用户体验的问题，根据我本人的访问体验以及他人的反馈，我会对站点逐步进行优化。下面是关于访问速度和性能方面的优化。\n本文以本站点为例，记录优化过"}}